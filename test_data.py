# test_data.py
import random
from app import db, app
from models import User, HealthRecord, Department, Announcement
from datetime import datetime, timedelta
from werkzeug.security import generate_password_hash

import pytz 
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
departments = ['hr', 'it', 'sales', 'marketing', 'finance']
names = [
    "è±Šå¶‹ è²´ç¾", "æœ¨æ‘ é›…è‹±", "ç™½æ¾¤ å‹å£«", "è¶Šæ™º çµè¡£", "å·æ‘ æ–‡å“‰", "ä½ã€…æœ¨ æ³°å­", "å‰ç”° èŒ", "åŸç”° ä¸€å½¦",
    "å¾³åŸ éš†å—£", "ä¸­è°· å¤§ç¥", "æ£®å´ å‹ä¹…", "æ¾æœ¬ ç¦", "æ‘ç”° åœ­ä¸€", "æ©‹æœ¬ èª å¸", "å°å³¶ æ”¿ä¿¡", "æœ¬é–“ ç¥",
    "é’æŸ³ ä¸€æµ", "å±±æœ¬ ä¸€éƒ", "ä¹…ä¿ç”° é‚¦æµ", "å‚æœ¬ æ˜Œä¹Ÿ", "æ–°è¦‹ å¥ä¸€", "ä¸‰æµ¦ ç§€å¹³", "å²¸ æ­£å¹¸", "ç›Šç”° å‰›",
    "å¤§é‡ ç¿”å¤ª", "éˆ´æœ¨ å’Œè£•", "çµåŸ æº€", "æ¾æµ¦ æ™ºå­", "è—¤äº• å¥å¤ªéƒ", "ä¼Šè—¤ å¼¥ç”Ÿ", "å¤§å€‰ å¹¸ç”Ÿ", "é«˜æ©‹ é–ç« ",
    "æ¡œäº• ç¥¥æ±Ÿ", "å±±ä¸‹ å¥äºŒ", "å°é‡ é”ä¹Ÿ", "è—¤äº• å‹‡äºº", "ä¸­å· æ­£ä¹Ÿ", "é•·è°·å· å‰›", "é è—¤ çœŸå®Ÿ", "ä½è—¤ å¤§åœ°",
    "å°æ±  æ„›å­", "ä»Šè¥¿ åƒé‡Œ", "å±±ç”° å‹å¼˜", "ç£¯è°· å¤èœ", "å¤§é‡ æ­£ç´˜", "æœ¨ä¸‹ é›„ä¸€éƒ", "å±±å†… é †å­", "å‹æµ¦ å¤§ä½œ",
    "å·é‚Š è£•å­", "æ¸¡è¾º æ˜¥ç¾", "å®‰ç”° åŠ å¥ˆ", "æ¸¡ä¼š æ™ºå­", "å±±ç”° å’Œç”·", "ç‰æœ¨ æ²™ç¹”", "é¦¬ç›® è£•è²´", "å±±ä¸‹ æ™´ä¹‹",
    "ä½è—¤ ç›´äºº", "æ­¦éƒ¨ å¥å¤ªéƒ", "è§’ç”° å•“ä¸€", "ä½è—¤ è¡ç¾", "è’äº• å°šå¹³", "æ‘æ¾ å¥ä¸€", "å±±ç”° ä¿¡å¤«", "éˆ´æœ¨ å„ªä¸€",
    "äº•æ‘ å“²", "å¤§æ±Ÿ ç«œå¤ª", "å‰ç”° é›„å¹³", "ç«¹å´ éƒå­", "ä½ã€…æœ¨ å…‹ä¹Ÿ", "é•·è°·å· æ ", "æœ¬å®® æ¸…", "æ¨ªå±± æµ©å—£",
    "è±æ²¼ å¹¸æµ", "å¤§ç€§ å‹‰", "ä¸‰æµ¦ æœ±é‡Œ", "é‡‘ é™½å¤ª", "å°å³¶ å“²ä¹Ÿ", "å°æ—©å· çœŸç†å­", "æ£®é‡ å…‰å­", "ä¹…ä¿ ç¾å’Œå­",
    "å‰æ‘ æº", "åœŸå² æ´‹å­", "å±±å²¸ æ–‡", "ä¸Šç”° æˆ¿æ±Ÿ", "è¬ä»£ å®ä¹‹", "æ± ä¸‹ è€•æ²»", "ç™¾ç”° éš†å¿—", "ä¸­æ‘ å¼˜",
    "æ‘ä¸Š ã¯ã‚‹ã‹", "å°å±± ä¹…ç¾", "ä¸‹æ¢ æ•", "ä¸ŠåŸ é”ä¹Ÿ", "ç‰ç”° æ™ºä¹Ÿ", "ç”°ä¸­ äº®", "æ¾æœ¬ æœ—", "é«˜æ¾¤ ç”±ç¾å­",
    "æˆç”° æ™´å­", "å®®ä¸‹ éº»è¡£", "è–¬å¸«å¯º çœŸä¸€éƒ", "è’äº• éº»ç¾", "éˆ´æœ¨ å‹ç¾", "ç³Ÿè°· ã‚ã„å­", "çŸ³æ£® æ„›", "ä¸‰åŸ æœ‰é¦™",
    "æ¸…æ°´ æº€", "è°· åƒçµµ", "åŠ è—¤ æ¶¼", "å € è±Š", "çŸ³è°· ä½³é‚£å­", "åŒ—ç”° çœŸç¾", "çŸ³å±± ç›´æ¨¹", "å…·å¿— è³¢ä¸€",
    "è‡¼äº• ç§€äºº", "å¤ªç”° å…¸å­", "æ°´è°· æ´¸å¤ª", "è—¤é‡ æœ‹å­", "ç”°ä¸­ é¡å­", "ä½è—¤ æœ—", "æ§™ çœŸå®Ÿ", "éˆ´æœ¨ å½©å­",
    "æ¨ªå· ã¾ã©ã‹", "ä¼Šè—¤ ç”±è¨˜", "é«˜ç”° æ™ºé¦™", "å¤§é«˜ å‹¤", "é•·è°·å· æ…§", "ä¸¸å±± å˜‰ä¸€", "åŸç”° éƒå®Ÿ", "å³¶é‡ éš†å¸",
    "è’æœ¨ å¤§è¼”", "ç«¹æ¾¤ æ—­", "å¹³äº• ä»ç¾", "åŒ—æ‘ æ­£äºº", "çŸ³äº• å’Œå½¦", "å¸‚åŸ åšå¸", "åŠç”° è–«", "å…ç‰ ã¿ã",
    "çŸ³å¡š å“çŸ¢", "ä¸­å±± è£•å¸", "ä¸­ä¸Š é¦™", "è¿‘è—¤ å“", "é«˜ç”° å’²å­", "æ­¦äº• æ­£è¡Œ", "åŒ—æ‘ éš†åºƒ", "è‹¥æ— èˆª",
    "æ— å°š", "çŸ³æ¯› æ¡‚å­", "éˆ´æœ¨ é‚¦æ˜", "ç‰§æ‘ ä½‘ä»‹", "è’²åœ° åœ­ç¥", "é«˜ç€¬ ç¥å¤ª", "å‚å…ƒ æ”¿æ˜", "ä½è—¤ å¹¸å¼˜",
    "é’æŸ³ ä¼¸å“‰", "ä¸­å³¶ çš“å¹³", "åŒ—å· æœªæ¥", "çŸ³è°· å•“ä¸€éƒ", "ä¸‰å®… å¥å¤ªéƒ", "éƒ¡å¸ æ†²", "å·æœ¬ ç›´è¡Œ", "ä¹…ä¿åœ’ ã‹ã»ã‚Š",
    "ç«¹ç”° æ˜ç¾©", "æ–°å€‰ æ™ƒå¼˜", "å‰ç”° ç”±é¦™é‡Œ", "å¡šç”° å„ªå¤ª", "å¯¿ è±Š", "å¸‚å· æ­£äºº", "åƒã€…å’Œ çœŸæ¨¹", "ä¸­æ‘ æ‹“ä¹Ÿ",
    "é¦¬å ´ ã‚†ã†ã“", "å†…å±± å“²å¿—", "æ©‹æœ¬ éº»è¡£å­", "æ–°æµ· é”å½¦", "ç”°ä¸­ è‰¯å¾³", "å²©ç”° ã¿ã‚†ã", "çŸ¢é‡ å¹¸é›„", "è—¤äº• é›„ä¸€éƒ",
    "é§’ç”° å…‹ä½³", "åŠ è—¤ æº", "åŠå· æ•æµ©", "æ˜Ÿ ç¾å½©å­", "å‰æ‘ é›…æ˜­", "çŸ³å¡š æ´‹", "æ¾ç”° ã‚ã‚„ã‹", "æ¸¡è¾º ç«œæ²»",
    "æ–‰æœ¨ å’Œå¸", "æŸ³ç€¬ ç”±è¨˜å­", "ä¼Šè—¤ è‚²å¤«", "ä¸‰äº• é€²", "å‰ä¸­ å¥ˆç¾", "å¤§çŸ³ ç³", "ç¥ç”° å®Ÿ", "æ©‹æœ¬ å¯›",
    "å®‰é” æ‹“å²", "é«˜æ‘ é‡Œç¾", "ç”ºç”° æ­£å’Œ", "å®ˆç”° äºŒéƒ", "åŠ èŒ‚ æ˜Œå¼˜", "è’å· ç§€ç”·", "äººè¦‹ è²´æ´‹", "æ°´è¶Š å¤©"
]

# ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã®ç™»éŒ²
def create_test_data():
    # æ—¥æœ¬ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’è¨­å®š
    tz = pytz.timezone('Asia/Tokyo')
    
    with open('employee_data.txt', 'w', encoding='utf-8') as f:
        for i in range(200):
            employee_number = f"EMP{i + 1:03}"
            name = names[i]
            department = random.choice(departments)
            phone = f"090-{random.randint(1000, 9999)}-{random.randint(1000, 9999)}"
            email = f"{name.replace(' ', '_').lower()}@example.com"
            password = generate_password_hash("password123")
            is_admin = True 
            
            user = User(
                password_hash=password,
                employee_number=employee_number,
                department=department,
                name=name,
                phone=phone,
                email=email,
                is_admin=is_admin
            )
            
            db.session.add(user)
            db.session.commit()

            for day in range(90):
                record_date = datetime.now(tz) - timedelta(days=day + 1)  # ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’è€ƒæ…®ã—ã¦æ—¥ä»˜ã‚’ç”Ÿæˆ
                Healthflag=0
                if day % 70 == 0 and 1 == random.randint(1, 10):
                    temperature = round(random.uniform(37.0, 38.5), 1)
                    Healthflag=1
                else:
                    temperature = round(random.uniform(36.0, 36.9), 1)
                
                if day % 70 == 0 and 1== random.randint(1, 10):
                    num_parts = random.randint(1, len(["é ­", "å³è…•", "å³è¶³", "è…¹", "å·¦è¶³", "èƒ¸", "å·¦è…•"]))
                    selected_parts = random.sample(["é ­", "å³è…•", "å³è¶³", "è…¹", "å·¦è¶³", "èƒ¸", "å·¦è…•"], num_parts)
                    Healthflag=1
                else:
                    selected_parts = []
                
                health_record = HealthRecord(
                    user_id=user.id,
                    temperature=temperature,
                    throat="normal",
                    fever="normal",
                    cough="no",
                    selected_parts=selected_parts,
                    date=record_date,
                    flag=Healthflag
                )
                db.session.add(health_record)

            db.session.commit()
            
            f.write(f"ç¤¾å“¡ç•ªå·: {employee_number}, åå‰: {name}, éƒ¨ç½²: {department}, "
                    f"é›»è©±: {phone}, ãƒ¡ãƒ¼ãƒ«: {email}\n")
            print(f"ç¤¾å“¡ {i + 1} / {len(names)}: {employee_number}: {name}ãŒç™»éŒ²ã•ã‚Œã¾ã—ãŸã€‚")
        
        print("å…¨ã¦ã®ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã®ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")


# åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã™ã‚‹é–¢æ•°
def insert_initial_departments():
    departments = [
        {'name': 'äººäº‹éƒ¨', 'abbreviation': 'hr'},
        {'name': 'ITéƒ¨é–€', 'abbreviation': 'it'},
        {'name': 'å–¶æ¥­éƒ¨', 'abbreviation': 'sales'},
        {'name': 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', 'abbreviation': 'marketing'},
        {'name': 'è²¡å‹™éƒ¨', 'abbreviation': 'finance'}
    ]
    
    for dept in departments:
        # æ–°ã—ã„éƒ¨é–€ã‚’ä½œæˆ
        new_department = Department(name=dept['name'], abbreviation=dept['abbreviation'])
        db.session.add(new_department)

    db.session.commit()
    print("å…¨ã¦ã®éƒ¨é–€ãƒ‡ãƒ¼ã‚¿ã®ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")  # éƒ¨é–€ç™»éŒ²å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

def creat_announcement_data():
    # æ—¥æœ¬ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’è¨­å®š
    tz = pytz.timezone('Asia/Tokyo')

    title = [
        "å¹´æœ«å¹´å§‹ä¼‘æ¥­ã®ãŠçŸ¥ã‚‰ã›",
        "å®‰å…¨å¯¾ç­–ã®å‘¼ã³ã‹ã‘",
        "è¨­å‚™ç‚¹æ¤œã«ä¼´ã†ãƒ©ã‚¤ãƒ³åœæ­¢ã®ã”æ¡ˆå†…"
    ]
    content = [
            """<p>æ—¥é ƒã‚ˆã‚Šå½“ç¤¾ã®æ¥­å‹™ã«ã”å”åŠ›ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>
            å¹´æœ«å¹´å§‹ã®ä¼‘æ¥­æ—¥ã«ã¤ã„ã¦ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚<br>
            ã€ä¼‘æ¥­æœŸé–“ã€‘12æœˆ29æ—¥ï¼ˆé‡‘ï¼‰ï½1æœˆ4æ—¥ï¼ˆæœ¨ï¼‰<br>
            ä¼‘æ¥­æœŸé–“ä¸­ã¯ç·Šæ€¥å¯¾å¿œã‚’é™¤ãã€ã™ã¹ã¦ã®æ¥­å‹™ã‚’åœæ­¢ã—ã¾ã™ã€‚
            <br>æ–°å¹´ã¯1æœˆ5æ—¥ï¼ˆé‡‘ï¼‰ã‚ˆã‚Šé€šå¸¸å–¶æ¥­ã‚’å†é–‹ã„ãŸã—ã¾ã™ã€‚
            <br>ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚</p>""",
            
           """<p>ã„ã¤ã‚‚ãŠç–²ã‚Œæ§˜ã§ã™ã€‚</p>
           <p>å®‰å…¨ç¬¬ä¸€ã§ä½œæ¥­ã‚’é€²ã‚ã¦ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ğŸ˜Š</p>
           <p>æœ€è¿‘ã€å·¥å ´å†…ã§ã®è»½å¾®ãªã‚±ã‚¬ã®å ±å‘ŠãŒå¢—ãˆã¦ã„ã¾ã™ã€‚<br>ä»Šé€±ã¯å®‰å…¨ç¢ºèªé€±é–“ã¨ã—ã€ä»¥ä¸‹ã®ãƒã‚¤ãƒ³ãƒˆã‚’å†åº¦ç¢ºèªã—ã¦ãã ã•ã„ï¼š</p>
           <ol>
               <li>ä½œæ¥­é–‹å§‹å‰ã«æ©Ÿå™¨ã®ç‚¹æ¤œã‚’è¡Œã†</li>
               <li>ä½œæ¥­ã‚¨ãƒªã‚¢ã®æ•´ç†æ•´é “ã‚’å¾¹åº•ã™ã‚‹</li>
               <li><strong><span style="color: #e03e2d; font-size: 18pt;">å®‰å…¨é´</span></strong>ã€<strong><span style="color: #e03e2d; font-size: 18pt;">ãƒ˜ãƒ«ãƒ¡ãƒƒãƒˆ</span></strong>ã®ç€ç”¨ã‚’å¿˜ã‚Œãªã„</li>
           </ol>
           <p>çš†ã•ã‚“ã®å”åŠ›ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>""",

            """<p>æ¥é€±ã®11æœˆ30æ—¥ï¼ˆæœ¨ï¼‰ã«ã€Aãƒ©ã‚¤ãƒ³ã®å®šæœŸè¨­å‚™ç‚¹æ¤œã‚’è¡Œã„ã¾ã™ã€‚
            <br>ä½œæ¥­ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å½±éŸ¿ãŒå‡ºã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã®ã§ã€è©²å½“ãƒ©ã‚¤ãƒ³ã§ã®ä½œæ¥­æ‹…å½“ã®æ–¹ã¯äº‹å‰ã«äºˆå®šã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚
            <br>ã€åœæ­¢æ™‚é–“å¸¯ã€‘<span style="color: #e03e2d; font-size: 18pt;">åˆå‰10æ™‚ï½åˆå¾Œ4æ™‚</span><br>
            ã”ä¸æ˜ç‚¹ã¯ã€è£½é€ éƒ¨ã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
            <p>è£½é€ éƒ¨é€£çµ¡å…ˆï¼š<a href="https://ja.wikipedia.org/wiki/%E3%83%81%E3%83%B3%E3%83%91%E3%83%B3%E3%82%B8%E3%83%BC" target="_blank" rel="noopener">
            https://www.hasegawako-.seizobu</a></p>"""
        ]

    for i in range(len(title)):
        record_date = datetime.now(tz) - timedelta(days=i * 5)
        existing_announcement = Announcement.query.filter_by(title=title[i]).first()
        if not existing_announcement:
            announcement = Announcement(
                title=title[i],
                content=content[i],
                date=record_date,  # ä¿®æ­£
            )
            db.session.add(announcement)

    db.session.commit()


if __name__ == '__main__':
    with app.app_context():  # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­å®š
        insert_initial_departments()  # åˆæœŸãƒ‡ãƒ¼ã‚¿ã®éƒ¨é–€ç™»éŒ²
        create_test_data()  # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç¤¾å“¡ç™»éŒ²
        creat_announcement_data() # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ãŠçŸ¥ã‚‰ã›ç™»éŒ²
    print("ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")
